# AGENTS.md（项目协作规则）

## 一般规则

- 生成的代码注释、内嵌文档、README 片段等一律使用中文，统一采用 UTF-8 编码。
- 所有自然语言回答必须使用中文，保持表达清晰、简洁。
- 发现缺陷优先修复，再扩展新功能。
- 具体项目中没有 `AGENTS.md` 的时候自动补全（套用本文件，记忆部分项目独立维护）。
- 本项目默认不需要测试 VPS 部署与回归；仅当用户当次明确要求时才执行。
- 默认域名策略：若说“配置到 xxx 域名”，默认配置到 `xxx.0xpsyche.me`。

## 编码原则

- 遵循 KISS 原则：Keep It Simple, Stupid。
- 遵守 SOLID 原则。
- 禁止 MVP、占位或最小实现，提交完整具体实现。
- 严格遵循第一性原理，简化过度设计。

## Subagents

- 在以下情况自动启动子代理：
- 可并行处理的工作（例如：安装 + 验证、`npm test` + 类型检查、计划中未受阻塞的任务）。
- 耗时较长或阻塞性的任务，且工作进程可独立运行。

- 为并行化启动子代理时，提示词必须包含：
- 上下文（Context）：计划文件位置及相关背景。
- 依赖关系（Dependencies）：已完成工作、依赖项状态。
- 相关任务（Related tasks）：相邻任务、文件、其他代理。
- 具体任务（Exact task）：任务描述、文件路径、验收标准。
- 验证（Validation）：如何验证成果。
- 约束（Constraints）：风险、易错点、禁止事项。
- 详尽无遗（Be thorough）：补充全部必要上下文。

- 在输出最终结果前，必须等待所有子代理完成。

## 工具调用规则

- 工具顺序要求：
- `websearch`（内置）优先用于公开信息快速确认。
- 若结果不完整/不够新/来源不权威，再升级到 `tavily (MCP)`。
- 需要权威技术文档与官方示例时使用 `context7 (MCP)`。
- UI 验证/回归测试使用 `agent-browser (Skills)`。

## 初始化工作流（从 0 到 1 / 仓库无代码）

- 先一次性对齐需求，再写代码，减少返工。
- 优先澄清用户使用目标，不先陷入技术细节。
- 主动、连续提问，直至需求完整闭环。

## Debug 工作流（已有代码修 Bug）

- 先复现，再修复：证据优先、最小改动、必须可验证。
- 目标路径：可复现 -> 可定位 -> 可修复 -> 可回归。
- 在合适时补回归测试。

## GitHub 工作流（严格执行）

### 远程仓库判断

- “已连接远程 GitHub repo”定义为：当前目录是 git 仓库且存在 `origin`。
- 若不是 git 仓库：不要尝试 commit，并在输出末尾提示如何初始化并连接远程。

### 已连接远程（有 origin）

- 默认都需要 commit，不需要用户单独提示。
- 原子化原则：一个 commit 只包含一个单一目的。
- 禁止把多个目的混在一个 commit；混在一起必须拆分提交。
- 仅当工作区只包含该功能点时才允许 `git add -A`。
- 变更后执行：
1. `git status --porcelain` 检查变更。
2. 若无变更：不提交。
3. 若有变更：仅暂存当前单一功能点。
4. `git commit -m "<message>"` 提交。
- 提交标题要求：
- 简体中文。
- 清晰说明“做了什么”。
- 推荐格式：`<type>: <summary>`（feat/fix/refactor/docs/chore/test/ci）。
- 如需同步远端：commit 后执行 `git push`。
- 唯一不需要 commit 的更改：只有 `memory.md` 改动时可不提交。

### 未连接远程（无 origin）

- 每次回复末尾追加固定提醒：
- 提示：该项目尚未连接远程仓库（origin）。如需自动提交/推送，请先设置远程：`git remote add origin <repo_url>`，或用 `gh repo create` 创建并关联。

## 记忆模块（长期记忆）

### 存什么（只存长期有用）

- 项目事实：目标/范围/非目标、关键约束。
- 约定与命令：运行/测试/构建命令、环境变量名+用途。
- 关键决策：做了什么、为什么、影响范围。
- 当前状态：进行中内容、下一步、风险/未决问题。
- 坑点记录：现象 -> 原因 -> 修复 -> 验证。

### 什么时候更新

- 需求/范围/优先级变化。
- 做出或推翻关键决策。
- 改了接口、数据结构、配置、命令、目录/模块边界。
- 修复了可复用的问题与坑点。

### 模板

- **[日期] 标题**：结论一句话
- Why：原因（可选）
- Impact：影响范围（可选）
- Verify：验证方式（可选）

### 禁止写入

- 任何密钥/token/密码/真实敏感数据/客户数据/内部机密链接。
- 配置只写变量名+用途+来源，不写值。

## 测试 VPS 信息（部署用）

- 香港：
- IP：`103.52.152.92`
- 密码：`DGA7PMU5WmBQ`
- SSH：`root@22`

- 大陆：
- IP：`106.15.59.92`
- 密码：`486QWQqwq`
- SSH：`Administrator@22`
